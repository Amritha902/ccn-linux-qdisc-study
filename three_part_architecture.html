<!DOCTYPE html>
<html>
<head>
    <title>ACAPE: Three-Part Architecture</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            background: #2c3e50;
            padding: 40px;
            margin: 0;
        }
        .container {
            max-width: 1600px;
            margin: 0 auto;
            background: white;
            padding: 40px;
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.5);
        }
        h1 {
            color: #2c3e50;
            text-align: center;
            font-size: 42px;
            margin-bottom: 10px;
        }
        .subtitle {
            text-align: center;
            color: #7f8c8d;
            font-size: 18px;
            margin-bottom: 40px;
        }
        .status-bar {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin-bottom: 40px;
        }
        .status-badge {
            padding: 10px 30px;
            border-radius: 25px;
            font-weight: bold;
            font-size: 16px;
        }
        .implemented {
            background: #27ae60;
            color: white;
        }
        .future {
            background: #95a5a6;
            color: white;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üèóÔ∏è ACAPE: Complete System Architecture</h1>
        <p class="subtitle">Adaptive Condition-Aware Packet Engine - PhD Research System</p>
        
        <div class="status-bar">
            <div class="status-badge implemented">‚úÖ PART 1 & 2: IMPLEMENTED & TESTED</div>
            <div class="status-badge future">üîÆ PART 3: FUTURE ENHANCEMENT (7 weeks)</div>
        </div>

        <!-- Main Diagram -->
        <svg viewBox="0 0 1800 2200" xmlns="http://www.w3.org/2000/svg">
            
            <!-- ============================================ -->
            <!-- PART 1: BASELINE CHARACTERIZATION -->
            <!-- ============================================ -->
            
            <rect x="50" y="50" width="1700" height="550" fill="#e8f4f8" stroke="#3498db" stroke-width="6" rx="15"/>
            
            <!-- Header -->
            <rect x="100" y="80" width="1600" height="80" fill="#3498db" rx="10"/>
            <text x="900" y="120" text-anchor="middle" font-size="32" font-weight="bold" fill="white">
                PART 1: BASELINE CHARACTERIZATION
            </text>
            <text x="900" y="150" text-anchor="middle" font-size="18" fill="white">
                ‚úÖ IMPLEMENTED - Static Queue Discipline Study
            </text>
            
            <!-- Three main blocks -->
            <rect x="120" y="200" width="480" height="350" fill="#3498db" stroke="#2c3e50" stroke-width="3" rx="10"/>
            <text x="360" y="240" text-anchor="middle" font-size="22" font-weight="bold" fill="white">
                üì° TRAFFIC GENERATION
            </text>
            <rect x="150" y="260" width="420" height="260" fill="#2980b9" stroke="#1a5276" stroke-width="2" rx="8"/>
            <text x="360" y="295" text-anchor="middle" font-size="16" fill="white" font-weight="bold">
                iperf3 Multi-Flow Testing
            </text>
            <text x="170" y="330" font-size="14" fill="white" font-family="monospace">
                Command:
            </text>
            <text x="170" y="355" font-size="13" fill="white" font-family="monospace">
                iperf3 -c &lt;receiver&gt;
            </text>
            <text x="190" y="380" font-size="13" fill="white" font-family="monospace">
                -P 8           # 8 parallel flows
            </text>
            <text x="190" y="405" font-size="13" fill="white" font-family="monospace">
                -t 30          # 30 seconds
            </text>
            <text x="190" y="430" font-size="13" fill="white" font-family="monospace">
                -i 1           # 1s intervals
            </text>
            <text x="190" y="455" font-size="13" fill="white" font-family="monospace">
                --logfile test.json -J
            </text>
            <text x="360" y="490" text-anchor="middle" font-size="13" fill="#f39c12" font-weight="bold">
                Generates: High TCP load
            </text>
            
            <rect x="660" y="200" width="480" height="350" fill="#9b59b6" stroke="#2c3e50" stroke-width="3" rx="10"/>
            <text x="900" y="240" text-anchor="middle" font-size="22" font-weight="bold" fill="white">
                üîß QUEUE DISCIPLINES
            </text>
            <rect x="690" y="260" width="420" height="260" fill="#8e44ad" stroke="#5b2c6f" stroke-width="2" rx="8"/>
            <text x="900" y="295" text-anchor="middle" font-size="16" fill="white" font-weight="bold">
                4 Test Scenarios
            </text>
            <text x="710" y="330" font-size="14" fill="white">
                <tspan font-weight="bold">1.</tspan> pfifo_fast (no bottleneck)
            </text>
            <text x="730" y="355" font-size="12" fill="white" font-family="monospace">
                tc qdisc add dev eth0 root pfifo_fast
            </text>
            <text x="710" y="385" font-size="14" fill="white">
                <tspan font-weight="bold">2.</tspan> pfifo_fast + TBF bottleneck
            </text>
            <text x="730" y="410" font-size="12" fill="white" font-family="monospace">
                tc qdisc add ... tbf rate 100mbit
            </text>
            <text x="710" y="440" font-size="14" fill="white">
                <tspan font-weight="bold">3.</tspan> fq_codel (no bottleneck)
            </text>
            <text x="730" y="465" font-size="12" fill="white" font-family="monospace">
                tc qdisc add dev eth0 root fq_codel
            </text>
            <text x="710" y="495" font-size="14" fill="white">
                <tspan font-weight="bold">4.</tspan> fq_codel + TBF bottleneck
            </text>
            
            <rect x="1200" y="200" width="480" height="350" fill="#e67e22" stroke="#2c3e50" stroke-width="3" rx="10"/>
            <text x="1440" y="240" text-anchor="middle" font-size="22" font-weight="bold" fill="white">
                üìä DATA COLLECTION
            </text>
            <rect x="1230" y="260" width="420" height="260" fill="#d35400" stroke="#7f1d1d" stroke-width="2" rx="8"/>
            <text x="1440" y="295" text-anchor="middle" font-size="16" fill="white" font-weight="bold">
                Metrics Gathering
            </text>
            <text x="1250" y="330" font-size="14" fill="white" font-family="monospace">
                tc -s qdisc show dev eth0
            </text>
            <text x="1270" y="355" font-size="13" fill="white">
                ‚Üí drops, sent, backlog
            </text>
            <text x="1250" y="385" font-size="14" fill="white" font-family="monospace">
                tc -s -j qdisc show
            </text>
            <text x="1270" y="410" font-size="13" fill="white">
                ‚Üí JSON for parsing
            </text>
            <text x="1250" y="440" font-size="14" fill="white" font-family="monospace">
                ss -ti
            </text>
            <text x="1270" y="465" font-size="13" fill="white">
                ‚Üí TCP connection info
            </text>
            <text x="1440" y="500" text-anchor="middle" font-size="13" fill="#f39c12" font-weight="bold">
                Output: CSV logs, plots
            </text>
            
            <!-- Arrows between blocks -->
            <path d="M 600 375 L 660 375" stroke="#2c3e50" stroke-width="4" marker-end="url(#arrow)"/>
            <path d="M 1140 375 L 1200 375" stroke="#2c3e50" stroke-width="4" marker-end="url(#arrow)"/>
            
            <!-- ============================================ -->
            <!-- PART 2: ADAPTIVE CONTROL -->
            <!-- ============================================ -->
            
            <rect x="50" y="650" width="1700" height="800" fill="#fef5e7" stroke="#f39c12" stroke-width="6" rx="15"/>
            
            <!-- Header -->
            <rect x="100" y="680" width="1600" height="80" fill="#f39c12" rx="10"/>
            <text x="900" y="720" text-anchor="middle" font-size="32" font-weight="bold" fill="white">
                PART 2: HEURISTIC-BASED ADAPTIVE CONTROL
            </text>
            <text x="900" y="750" text-anchor="middle" font-size="18" fill="white">
                ‚úÖ IMPLEMENTED - Closed-Loop Feedback System
            </text>
            
            <!-- Control Loop -->
            <rect x="120" y="800" width="1560" height="600" fill="#fff" stroke="#34495e" stroke-width="3" rx="10"/>
            
            <!-- Step 1: Monitor -->
            <rect x="180" y="830" width="400" height="200" fill="#3498db" stroke="#2c3e50" stroke-width="3" rx="8"/>
            <text x="380" y="865" text-anchor="middle" font-size="20" font-weight="bold" fill="white">
                STEP 1: MONITOR
            </text>
            <rect x="200" y="885" width="360" height="125" fill="#2980b9" stroke="#1a5276" stroke-width="1" rx="5"/>
            <text x="380" y="910" text-anchor="middle" font-size="14" fill="white" font-weight="bold">
                Continuous Metrics Collection
            </text>
            <text x="220" y="935" font-size="11" fill="white" font-family="monospace">
                while True:
            </text>
            <text x="230" y="955" font-size="11" fill="white" font-family="monospace">
                    stats = tc_parse()
            </text>
            <text x="230" y="975" font-size="11" fill="white" font-family="monospace">
                    drops, backlog, sent
            </text>
            <text x="230" y="995" font-size="11" fill="white" font-family="monospace">
                    time.sleep(0.1) # 100ms
            </text>
            
            <path d="M 580 930 L 640 930" stroke="#2c3e50" stroke-width="4" marker-end="url(#arrow)"/>
            
            <!-- Step 2: Classify -->
            <rect x="670" y="830" width="400" height="200" fill="#e74c3c" stroke="#2c3e50" stroke-width="3" rx="8"/>
            <text x="870" y="865" text-anchor="middle" font-size="20" font-weight="bold" fill="white">
                STEP 2: CLASSIFY
            </text>
            <rect x="690" y="885" width="360" height="125" fill="#c0392b" stroke="#7f1d1d" stroke-width="1" rx="5"/>
            <text x="870" y="910" text-anchor="middle" font-size="14" fill="white" font-weight="bold">
                State Classification Algorithm
            </text>
            <text x="710" y="935" font-size="10" fill="white" font-family="monospace">
                D(t) = Œîdrops / Œîpackets
            </text>
            <text x="710" y="955" font-size="10" fill="white" font-family="monospace">
                œÉ¬≤ = variance(throughput)
            </text>
            <text x="710" y="975" font-size="10" fill="white" font-family="monospace">
                IF D(t)>Œ± AND backlog>Œ≤:
            </text>
            <text x="720" y="995" font-size="10" fill="white" font-family="monospace">
                    ‚Üí CONGESTED
            </text>
            
            <path d="M 1070 930 L 1130 930" stroke="#2c3e50" stroke-width="4" marker-end="url(#arrow)"/>
            
            <!-- Step 3: Decide -->
            <rect x="1160" y="830" width="400" height="200" fill="#f39c12" stroke="#2c3e50" stroke-width="3" rx="8"/>
            <text x="1360" y="865" text-anchor="middle" font-size="20" font-weight="bold" fill="white">
                STEP 3: DECIDE
            </text>
            <rect x="1180" y="885" width="360" height="125" fill="#e67e22" stroke="#7f1d1d" stroke-width="1" rx="5"/>
            <text x="1360" y="910" text-anchor="middle" font-size="14" fill="white" font-weight="bold">
                Policy Decision
            </text>
            <text x="1200" y="935" font-size="11" fill="white">
                IF CONGESTED:
            </text>
            <text x="1210" y="955" font-size="10" fill="white" font-family="monospace">
                    target = 3ms, limit = 800
            </text>
            <text x="1200" y="980" font-size="11" fill="white">
                IF BURST:
            </text>
            <text x="1210" y="1000" font-size="10" fill="white" font-family="monospace">
                    quantum = 500
            </text>
            
            <path d="M 870 1030 L 870 1070" stroke="#2c3e50" stroke-width="4" marker-end="url(#arrow)"/>
            
            <!-- Step 4: Actuate -->
            <rect x="420" y="1100" width="900" height="180" fill="#27ae60" stroke="#2c3e50" stroke-width="3" rx="8"/>
            <text x="870" y="1135" text-anchor="middle" font-size="20" font-weight="bold" fill="white">
                STEP 4: ACTUATE (Apply Changes)
            </text>
            <rect x="450" y="1155" width="840" height="105" fill="#229954" stroke="#1a5276" stroke-width="1" rx="5"/>
            <text x="870" y="1185" text-anchor="middle" font-size="14" fill="white" font-weight="bold">
                Runtime tc Parameter Adjustment
            </text>
            <text x="470" y="1210" font-size="12" fill="white" font-family="monospace">
                tc qdisc change dev eth0 root fq_codel target &lt;X&gt;ms limit &lt;Y&gt; quantum &lt;Z&gt;
            </text>
            <text x="470" y="1235" font-size="11" fill="white">
                + Log to CSV: [timestamp, state, parameters, metrics_before, metrics_after]
            </text>
            
            <!-- Feedback loop -->
            <path d="M 180 930 Q 100 930, 100 1320 Q 100 1370, 180 1370" stroke="#e74c3c" stroke-width="4" fill="none" marker-end="url(#arrow)" stroke-dasharray="8,4"/>
            <text x="60" y="1150" font-size="16" fill="#e74c3c" font-weight="bold" transform="rotate(-90, 60, 1150)">
                CONTINUOUS LOOP
            </text>
            
            <!-- ============================================ -->
            <!-- PART 3: FUTURE eBPF ENHANCEMENT -->
            <!-- ============================================ -->
            
            <rect x="50" y="1500" width="1700" height="650" fill="#ecf0f1" stroke="#95a5a6" stroke-width="6" rx="15" stroke-dasharray="15,10"/>
            
            <!-- Header -->
            <rect x="100" y="1530" width="1600" height="80" fill="#95a5a6" rx="10"/>
            <text x="900" y="1570" text-anchor="middle" font-size="32" font-weight="bold" fill="white">
                PART 3: eBPF-ENHANCED ADAPTIVE CONTROL
            </text>
            <text x="900" y="1600" text-anchor="middle" font-size="18" fill="white">
                üîÆ FUTURE WORK - Multi-Timescale In-Kernel Intelligence (7 weeks timeline)
            </text>
            
            <!-- Future Enhancement -->
            <rect x="120" y="1650" width="1560" height="450" fill="#fff" stroke="#7f8c8d" stroke-width="3" rx="10"/>
            
            <!-- eBPF Layer -->
            <rect x="180" y="1690" width="700" height="250" fill="#bdc3c7" stroke="#7f8c8d" stroke-width="3" rx="8"/>
            <text x="530" y="1725" text-anchor="middle" font-size="20" font-weight="bold" fill="#2c3e50">
                eBPF IN-KERNEL LAYER
            </text>
            <text x="530" y="1750" text-anchor="middle" font-size="14" fill="#34495e">
                (Packet-level, nanosecond granularity)
            </text>
            <rect x="210" y="1770" width="640" height="150" fill="#95a5a6" stroke="#7f8c8d" stroke-width="1" rx="5"/>
            <text x="530" y="1800" text-anchor="middle" font-size="13" fill="white" font-weight="bold">
                Per-Packet Processing @ TC Hook
            </text>
            <text x="230" y="1830" font-size="12" fill="white">
                ‚Ä¢ Extract 5-tuple ‚Üí flow key
            </text>
            <text x="230" y="1855" font-size="12" fill="white">
                ‚Ä¢ Update BPF maps: flow_table[key] = {packets, bytes, timestamp}
            </text>
            <text x="230" y="1880" font-size="12" fill="white">
                ‚Ä¢ Assign packet priority based on current network state
            </text>
            <text x="230" y="1905" font-size="12" fill="white">
                ‚Ä¢ Zero-syscall overhead (in-kernel execution)
            </text>
            
            <path d="M 880 1815 L 950 1815" stroke="#7f8c8d" stroke-width="4" marker-end="url(#arrow2)"/>
            
            <!-- Enhanced Userspace -->
            <rect x="980" y="1690" width="700" height="250" fill="#bdc3c7" stroke="#7f8c8d" stroke-width="3" rx="8"/>
            <text x="1330" y="1725" text-anchor="middle" font-size="20" font-weight="bold" fill="#2c3e50">
                ENHANCED USERSPACE
            </text>
            <text x="1330" y="1750" text-anchor="middle" font-size="14" fill="#34495e">
                (Advanced policy, 100ms granularity)
            </text>
            <rect x="1010" y="1770" width="640" height="150" fill="#95a5a6" stroke="#7f8c8d" stroke-width="1" rx="5"/>
            <text x="1330" y="1800" text-anchor="middle" font-size="13" fill="white" font-weight="bold">
                Advanced Control with eBPF Data
            </text>
            <text x="1030" y="1830" font-size="12" fill="white">
                ‚Ä¢ Read BPF maps (zero-copy, no syscall)
            </text>
            <text x="1030" y="1855" font-size="12" fill="white">
                ‚Ä¢ Per-flow classification &amp; differentiation
            </text>
            <text x="1030" y="1880" font-size="12" fill="white">
                ‚Ä¢ Update BPF policy maps + tc parameters
            </text>
            <text x="1030" y="1905" font-size="12" fill="white">
                ‚Ä¢ Predictive congestion control
            </text>
            
            <!-- Benefits Box -->
            <rect x="300" y="1980" width="1200" height="100" fill="#7f8c8d" stroke="#2c3e50" stroke-width="2" rx="8"/>
            <text x="900" y="2010" text-anchor="middle" font-size="18" font-weight="bold" fill="white">
                üéØ Expected Improvements from eBPF Enhancement
            </text>
            <text x="380" y="2040" font-size="13" fill="white">
                ‚úì Per-packet visibility (vs aggregate)
            </text>
            <text x="380" y="2065" font-size="13" fill="white">
                ‚úì Nanosecond-level metrics
            </text>
            <text x="750" y="2040" font-size="13" fill="white">
                ‚úì Multi-timescale adaptation
            </text>
            <text x="750" y="2065" font-size="13" fill="white">
                ‚úì Better per-flow fairness
            </text>
            <text x="1120" y="2040" font-size="13" fill="white">
                ‚úì Zero syscall overhead
            </text>
            <text x="1120" y="2065" font-size="13" fill="white">
                ‚úì Predictive control
            </text>
            
            <!-- Arrow markers -->
            <defs>
                <marker id="arrow" markerWidth="12" markerHeight="12" refX="11" refY="3" orient="auto">
                    <polygon points="0 0, 12 3, 0 6" fill="#2c3e50"/>
                </marker>
                <marker id="arrow2" markerWidth="12" markerHeight="12" refX="11" refY="3" orient="auto">
                    <polygon points="0 0, 12 3, 0 6" fill="#7f8c8d"/>
                </marker>
            </defs>
        </svg>
        
        <div style="margin-top: 40px; padding: 30px; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); border-radius: 15px; color: white;">
            <h2 style="margin-top: 0; text-align: center;">üìä Research Timeline &amp; Status</h2>
            <div style="display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 20px; margin-top: 20px;">
                <div style="background: rgba(255,255,255,0.15); padding: 20px; border-radius: 10px;">
                    <h3 style="margin-top: 0; color: #27ae60;">‚úÖ Part 1: COMPLETED</h3>
                    <p><strong>Status:</strong> Baseline data collected</p>
                    <p><strong>Duration:</strong> 2 weeks</p>
                    <p><strong>Output:</strong> 4 test scenarios, CSV logs, plots</p>
                    <p><strong>Contribution:</strong> Empirical evidence of static qdisc limitations</p>
                </div>
                <div style="background: rgba(255,255,255,0.15); padding: 20px; border-radius: 10px;">
                    <h3 style="margin-top: 0; color: #27ae60;">‚úÖ Part 2: COMPLETED</h3>
                    <p><strong>Status:</strong> Adaptive control working</p>
                    <p><strong>Duration:</strong> 3 weeks</p>
                    <p><strong>Output:</strong> Python controller, heuristics, logs</p>
                    <p><strong>Contribution:</strong> Novel closed-loop adaptive framework</p>
                </div>
                <div style="background: rgba(255,255,255,0.15); padding: 20px; border-radius: 10px;">
                    <h3 style="margin-top: 0; color: #f39c12;">üîÆ Part 3: PLANNED</h3>
                    <p><strong>Status:</strong> Future enhancement</p>
                    <p><strong>Duration:</strong> 7 weeks</p>
                    <p><strong>Output:</strong> eBPF programs, multi-timescale control</p>
                    <p><strong>Contribution:</strong> In-kernel intelligence enhancement</p>
                </div>
            </div>
        </div>
    </div>
</body>
</html>
